<div class="container">
  <% if flash[:message] != nil %>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <div class="w3-panel w3-blue w3-display-container" style="margin-top: 50px;">
    <span onclick="this.parentElement.style.display='none'"class="w3-button w3-blue w3-large w3-display-topright">&times;</span>
    <h4  class="mb-1 text-center">Atenci√≥n!</h4>
    <br>
    <p class="mb-1 text-center"><%= flash[:message] %></p>
    <%flash[:message]=nil%>
    </div>
  <%end%>
  <form class="form-inline" action="/users/update" method="get">
    <% nro = 0 %>
    <div class="well">
      Nombre : <%= @user.nombre  %>
      <button id="editbutton<%= nro %>" style="margin-left: 2%; visibility:hidden " type="button" class="btn" onclick="mostrarCampo(<%= nro%>)">Editar</button>
      <input type="text"  name="nombre" id="campo<%= nro %>" style="visibility:hidden">
      <% nro = nro + 1 %>
    </div>
    <div class="well">
      Apellido : <%= @user.apellido  %>
      <button id="editbutton<%= nro %>" style="margin-left: 2%; visibility:hidden " type="button" class="btn" onclick="mostrarCampo(<%= nro%>)">Editar</button>
      <input type="text"  name="apellido" id="campo<%= nro %>" style="visibility:hidden">
      <% nro = nro + 1 %>
    </div>
    <div class="well">
      Mail : <%= @user.mail  %>
      <button id="editbutton<%= nro %>" style="margin-left: 2%; visibility:hidden " type="button" class="btn" onclick="mostrarCampo(<%= nro%>)">Editar</button>
      <input type="email"  name="email" id="campo<%= nro %>" style="visibility:hidden">
      <% nro = nro + 1 %>
    </div>
    <div class="well">
      <%if @user.faculty_id !=0%>
        Facultad : <%= @facultades.find(@user.faculty_id).nombre  %>
      <%else%>
        Facultad : Ninguna  %>
      <%end%>
      <button id="editbutton<%= nro %>" style="margin-left: 2%; visibility:hidden " type="button" class="btn" onclick="mostrarCampo(<%= nro%>)">Editar</button>
      <div class="form-group" id="campo<%= nro %>" style="visibility:hidden">
          <select id="facultad_id" name="facultad_id" class="form-control">
          <option value="-">-</option>
          <option value=0>Ninguna</option>
          <% @facultades.order(:nombre).each do |facultad| %>
              <% if facultad.id != @user.faculty_id %>
                <option value=<%=facultad.id%>> <%=facultad.nombre%> - <%=@direcciones.find(facultad.direction_id).ciudad%>, <%=@direcciones.find(facultad.direction_id).calle%></option>
              <%end%>
          <% end %>
          </select>
      </div>
    </div>
    <div class="well">
      Puntos : <%= @user.puntos  %>
    </div>
    <div class="well">
      Nivel : <%= @niveles.find(@user.level_id).nombre  %>
    </div>
    <button id="startbutton" style="margin-left: 2%" type="button" class="btn" onclick="mostrarBotones(<%=nro%>)">Editar mi perfil</button>
    <input type="hidden" class="form-control" name="user_id" id="user_id" value=<%=@user.id%>>
    <button id="confirmbutton" style="margin-left: 2%; visibility:hidden" type="submit" class="btn btn-primary">Enviar cambios</button>
    <button id="cancelbutton" style="margin-left: 2%; visibility:hidden" type="button" class="btn btn-danger" onclick="cancelarEdicion(<%=nro%>)">Cancelar</button>
  </form>
  <div class="well" style="margin-top: 2%">
    Preguntas realizadas : <br>
  </div>
  <div class="row" style="padding-left: 10%;padding-right: 10%;margin-top: 25px;padding-top: 2%;">
    <div class="list-group" style="overflow: auto;width: 70%;margin:auto">
      <% @preguntas.order(created_at: :DESC).each do |question| %>
      <% @question=question %>
      <%= render 'question'  %>
      <% end %>
    </div>
  </div>
</div>

<script type="text/javascript">
  function mostrarBotones (cant) {
    for (i=0; i<=cant; i++) {
      idboton = "editbutton" + i
      document.getElementById(idboton).style.visibility = 'visible'
    }
    document.getElementById("confirmbutton").style.visibility = 'visible'
    document.getElementById("cancelbutton").style.visibility = 'visible'
    document.getElementById("startbutton").style.visibility = 'hidden'
  }
  function mostrarCampo (nro) {
    idcampo = "campo" + nro
    if (document.getElementById(idcampo).style.visibility == 'hidden')
      document.getElementById(idcampo).style.visibility = 'visible'
    else
      document.getElementById(idcampo).style.visibility = 'hidden'
  }
  function cancelarEdicion (cant) {
    for (i=0; i<=cant; i++) {
      idboton = "editbutton" + i
      document.getElementById(idboton).style.visibility = 'hidden'
    }
    for (i=0; i<=cant; i++) {
      idcampo = "campo" + i
      document.getElementById(idcampo).style.visibility = 'hidden'
    }
    limpiarCampos()
  }

  function limpiarCampos () {
    document.getElementById("confirmbutton").style.visibility = 'hidden'
    document.getElementById("cancelbutton").style.visibility = 'hidden'
    document.getElementById("startbutton").style.visibility = 'visible'
    document.getElementById("campo0").value = ""
    document.getElementById("campo1").value = ""
    document.getElementById("campo2").value = ""
    document.getElementById("facultad_id").selectedIndex = 0
  }

</script>
